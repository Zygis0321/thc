(this.webpackJsonpthc=this.webpackJsonpthc||[]).push([[0],{303:function(e,t,a){e.exports=a(524)},308:function(e,t,a){},309:function(e,t,a){},524:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(16),o=a.n(l),i=(a(308),a(28)),c=a(29),s=a(38),p=a(37),u=a(258),m=a(19),h=(a(309),a(259)),d=a(89),f=new(function(){function e(){var t=this;Object(i.a)(this,e),this.prefScores=[],this.rankPlayers=function(e){for(var a=0;a<e.length;a++)-1!==e[a].lowestScore&&(e[a].newPoints=e[a].points+Math.max(0,e[a].score-e[a].lowestScore));for(var n=0;n<e.length;n++)if(-1!==e[n].lowestScore){for(var r=t.prefScores[e[n].newPoints+1]+1,l=0;l<e.length;l++)-1!==e[l].lowestScore&&(e[l].points>e[n].newPoints&&r--,e[l].newPoints>e[n].newPoints&&r++);e[n].rank=t.prefScores[e[n].points+1]+1,e[n].newRank=r}return e},this.recalc=function(e,t){for(var a=0;a<e.length;a++)e[a].pos=a+1,e[a].score=0;if(e.length<4)return e;for(var n=e.map((function(e){return e.value})).sort((function(e,t){return t-e})),r=0;r+1<e.length;r++){for(var l=0,o=r;o<Math.min(r+4,e.length);o++)l+=n[o];e[r].score=Math.max(e[r].score,l/4*t.coefficient)}for(var i=0;i<e.length;i++){var c=69*(e.length-i-1)/(e.length-1)+1;e[i].score=Math.max(e[i].score,Math.min(c,e.length-i))}for(var s=t.winnerpoints,p=0;p+1<e.length;p++)e[p].score=Math.max(e[p].score,s),s/=2;for(var u=0;u<e.length;u++){var m=(t.winnerpoints-1)*(e.length-u-1)/(e.length-1)+1;e[u].score=Math.max(e[u].score,m)}for(var h=0;h<e.length;h++)e[h].score=Math.floor(e[h].score);return e[0].score+=10,e}}return Object(c.a)(e,[{key:"parseContent",value:function(e){for(var t=e.split("\n").map((function(e){return e.split("\t")})),a=[],n=2;n+1<t.length;n++){var r={rank:Number(t[n][0]),id:t[n][1],name:t[n][2],club:t[n][3],nation:t[n][4],points:Number(t[n][5]),value:Number(t[n][6])};a.push(r)}return a}},{key:"parsePlayerMinPoints",value:function(e){var t=document.createElement("html");t.innerHTML=e;for(var a=t.getElementsByClassName("normTour"),n=1e5,r=0,l=6;l<a.length;l+=7){var o=a[l].innerHTML.indexOf("(");-1===o&&(o=a[l].innerHTML.length);var i=a[l].innerHTML.substr(0,o);n=Math.min(n,Number(i)),r++}return r<5&&(n=0),n}},{key:"setPlayerScores",value:function(e){this.prefScores=new Array(6005).fill(0);for(var t=0;t<e.length;t++)this.prefScores[e[t].points]++;for(var a=6e3;a>=0;a--)this.prefScores[a]+=this.prefScores[a+1]}}]),e}()),g=a(560),y=a(559),v=a(528),E=a(562),w=a(563),b=a(576),C=a(580),D=a(577),k=a(561),j=a(566),P=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={searchText:""},e.handleSearchChange=function(t){e.setState({searchText:t.target.value})},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{label:"Players",variant:"outlined",onChange:this.handleSearchChange,fullWidth:!0,InputProps:{endAdornment:r.a.createElement(g.a,{position:"end"},r.a.createElement(k.a,{color:"action"}))}}),r.a.createElement(y.a,{dense:!0},(this.props.players.length?this.props.players.filter((function(t){return t.name.toLowerCase().includes(e.state.searchText.toLowerCase())})).slice(0,10):Array.from(new Array(10))).map((function(t){return t?r.a.createElement(v.a,{key:t.id,button:!0,onClick:function(){return e.props.handlePlayerToggle(t)}},r.a.createElement(E.a,{id:t.id+t.name,primary:t.name,secondary:t.club}),r.a.createElement(w.a,null,r.a.createElement(b.a,{edge:"end",onChange:function(){return e.props.handlePlayerToggle(t)},checked:e.props.playersCompare.some((function(e){return e.id==t.id}))}))):r.a.createElement(C.a,{pt:2,pl:1,pr:1},r.a.createElement(j.a,null),r.a.createElement(j.a,{width:"60%"}))}))))}}]),a}(n.Component),O=a(78),T=a.n(O),x=a(569),S=a(567),U=a(556),R=a(579),L=a(574),A=a(570),M=a(571),Y=a(243),F=a.n(Y),I=[{name:"Level 1 (World)",coefficient:.96,winnerpoints:1e3},{name:"Level 1 (Continental)",coefficient:.96,winnerpoints:600},{name:"Level 2",coefficient:.92,winnerpoints:500},{name:"Level 3",coefficient:.89,winnerpoints:100},{name:"Level 4",coefficient:.83,winnerpoints:70},{name:"Level 5",coefficient:.6,winnerpoints:40},{name:"Level 6",coefficient:.4,winnerpoints:20}],N=[{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:0,percentage:1},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(2020,9,4)),tournamentAge:2,percentage:.8},{appliedFrom:new Date(Date.UTC(2020,9,5)),appliedUntil:new Date(Date.UTC(2021,5,30)),tournamentAge:2,percentage:1},{appliedFrom:new Date(Date.UTC(2021,6,1)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:2,percentage:.8},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:3,percentage:.6},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:4,percentage:.4},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:5,percentage:.2},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:6,percentage:0}],W=(new Date(Date.UTC(2020,9,5)),new Date(Date.UTC(2021,6,1)),a(572)),B=a(99),H=a(564),J=a(172),K=a(568),V={boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.2)",backgroundColor:"rgb(255, 255, 255)",marginTop:"12px",marginBottom:"12px"},_={fontWeight:600,color:"#5eb560"},z={fontWeight:600,color:"#f97373"},$={fontWeight:600,color:"#969696"},q=Object(J.b)((function(e){var t=e.children;return r.a.createElement(v.a,{style:V},t)})),G=Object(J.a)((function(e){var t=e.children;return r.a.createElement(y.a,null,t)})),Q=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(G,{onSortEnd:this.props.reorder,shouldCancelStart:function(e){if("buttonRemove"==e.target.id||void 0!==e.target.nearestViewportElement&&"buttonRemove"===e.target.nearestViewportElement.id)return!0},useWindowAsScrollContainer:!0},r.a.createElement(v.a,null,r.a.createElement(S.a,{item:!0,xs:1},r.a.createElement(B.a,null,"#")),r.a.createElement(S.a,{item:!0,xs:4},r.a.createElement(B.a,null,"Name")),r.a.createElement(S.a,{item:!0,xs:!0},r.a.createElement(B.a,null,"Rank")),r.a.createElement(S.a,{item:!0,xs:!0},r.a.createElement(B.a,null,"Points")),r.a.createElement(S.a,{item:!0,xs:2},r.a.createElement(B.a,{align:"justify"},"Tournament Points"))),this.props.playersCompare.map((function(t,a){return r.a.createElement(q,{key:a,index:a},r.a.createElement(S.a,{item:!0,xs:1},r.a.createElement(B.a,null,r.a.createElement("b",null,t.pos))),r.a.createElement(S.a,{item:!0,xs:4},r.a.createElement(B.a,null,t.name)),r.a.createElement(S.a,{item:!0,xs:!0},-1===t.lowestScore?r.a.createElement(j.a,{width:70}):r.a.createElement(S.a,{container:!0,direction:"row"},r.a.createElement(C.a,{mr:.5},r.a.createElement(B.a,null,t.newRank)),t.rank>t.newRank?r.a.createElement(B.a,{style:_},"(+".concat(Math.abs(t.rank-t.newRank),")")):t.rank===t.newRank?r.a.createElement(B.a,{style:$},"(=".concat(t.rank-t.newRank,")")):r.a.createElement(B.a,{style:z},"(-".concat(Math.abs(t.rank-t.newRank),")")))),r.a.createElement(S.a,{item:!0,xs:!0},-1===t.lowestScore?r.a.createElement(j.a,{width:70}):r.a.createElement(S.a,{container:!0,direction:"row"},r.a.createElement(C.a,{mr:.5},r.a.createElement(B.a,null,t.newPoints)),t.points<t.newPoints?r.a.createElement(B.a,{style:_},"(+".concat(Math.abs(t.points-t.newPoints),")")):r.a.createElement(B.a,{style:$},"(=".concat(t.points-t.newPoints,")")))),r.a.createElement(S.a,{item:!0,xs:2},r.a.createElement(S.a,{container:!0,direction:"row",justify:"flex-end"},r.a.createElement(C.a,{display:"flex",alignItems:"center",justifyContent:"flex-end",marginRight:2},r.a.createElement(B.a,{align:"right"},r.a.createElement("b",null,t.score))),r.a.createElement(C.a,{display:"flex",alignItems:"center",justifyContent:"flex-end"},r.a.createElement(H.a,{size:"small",onClick:function(){return e.props.playerRemoved(t.id)},id:"buttonRemove"},r.a.createElement(K.a,{id:"buttonRemove"}))))))})))}}]),a}(n.Component),X=a(59),Z=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={playersCompare:[],selectedLevel:I[0].name},e.recalc=function(e,t){var a=I.find((function(e){return e.name==t})),n=a||I[0];return f.rankPlayers(f.recalc(e,n))},e.reorder=function(t){var a=t.oldIndex,n=t.newIndex;e.setState((function(t){var r=t.playersCompare;return{playersCompare:e.recalc(F()(r,a,n),e.state.selectedLevel)}}))},e.handlePlayerToggle=function(t){e.state.playersCompare.some((function(e){return e.id==t.id}))?e.playerRemoved(t.id):e.playerAdded(t)},e.playerAdded=function(t){e.setState((function(a){return Object(d.a)(Object(d.a)({},a),{},{playersCompare:e.recalc(a.playersCompare.concat(Object(d.a)(Object(d.a)({},t),{},{pos:a.playersCompare.length+1,score:-1,lowestScore:-1,newRank:-1,newPoints:-1})),a.selectedLevel)})})),T.a.ajax("https://serene-crag-74633.herokuapp.com/single/"+t.id).then((function(a){for(var n=Number(a),r=Object(h.a)(e.state.playersCompare),l=0;l<r.length;l++)if(r[l].id===t.id&&-1===r[l].lowestScore){var o=Object(d.a)({},r[l]);o.lowestScore=n,r[l]=o,e.setState({playersCompare:e.recalc(r,e.state.selectedLevel)});break}})).catch((function(){console.log("error")}))},e.handleClearAllClick=function(){e.setState({playersCompare:[]})},e.playerRemoved=function(t){e.setState((function(a){var n=a.playersCompare,r=a.selectedLevel;return{playersCompare:e.recalc(n.filter((function(e){return e.id!==t})),r)}}))},e.handleLevelChange=function(t){e.setState((function(a){var n=a.playersCompare;return{selectedLevel:t.target.value,playersCompare:e.recalc(n,t.target.value)}}))},e}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e){0===e.players.length&&this.props.players.length>0&&f.setPlayerScores(this.props.players)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement(x.a,null,r.a.createElement(C.a,{pt:5},r.a.createElement(S.a,{container:!0,spacing:3},r.a.createElement(S.a,{item:!0,xs:3},r.a.createElement(P,{players:this.props.players,handlePlayerToggle:this.handlePlayerToggle,playersCompare:this.state.playersCompare})),r.a.createElement(S.a,{item:!0,xs:!0},r.a.createElement(S.a,{container:!0,justify:"space-between",alignItems:"center"},r.a.createElement(S.a,{item:!0},r.a.createElement(U.a,null,r.a.createElement(R.a,null,"Level"),r.a.createElement(L.a,{value:this.state.selectedLevel,onChange:this.handleLevelChange},I.map((function(e){return r.a.createElement(A.a,{value:e.name},e.name)}))))),r.a.createElement(S.a,{item:!0},r.a.createElement(M.a,{variant:"contained",color:"secondary",startIcon:r.a.createElement(W.a,null),onClick:this.handleClearAllClick,style:{float:"right"}},"Clear"))),r.a.createElement(Q,{playersCompare:this.state.playersCompare,reorder:this.reorder,playerRemoved:this.playerRemoved})))))}}]),a}(n.Component),ee=Object(X.b)((function(e){return{players:e.players}}))(Z);var te=a(573),ae=a(255),ne=a.n(ae),re=a(254),le=a.n(re),oe=a(256),ie=a.n(oe),ce=a(575),se=a(582),pe=a(167),ue=new function e(){var t=this;Object(i.a)(this,e),this.addYears=function(e,t){var a=new Date(e);return new Date(a.setFullYear(a.getFullYear()+t))},this.getPointsByDate=function(e){for(var a=Date.now(),n=[],r=0;r<e.length;r++){var l,o=Object(pe.a)(N);try{for(o.s();!(l=o.n()).done;){var i=l.value,c=t.addYears(e[r].date,i.tournamentAge);c<i.appliedFrom||c>i.appliedUntil||n.push({date:c,points:Math.round(e[r].points*i.percentage),ind:r})}}catch(f){o.e(f)}finally{o.f()}}n=n.sort((function(e,t){return new Date(e.date).getTime()-new Date(t.date).getTime()}));var s,p=[],u=[],m=Object(pe.a)(n);try{var h=function(){var e=s.value;(p=p.filter((function(t){return t.ind!==e.ind}))).push(e),p=p.sort((function(e,t){return t.points-e.points}));for(var t=0,a=0;a<Math.min(p.length,5);a++)t+=p[a].points;u.push({date:e.date,points:t})};for(m.s();!(s=m.n()).done;)h()}catch(f){m.e(f)}finally{m.f()}var d=Date.now();return console.log("elapsed "+(d-a)),u},this.scalePointsByDate=function(e,t,a,n){for(var r=a.getTime(),l=n.getTime(),o=(l-r)/t,i=0,c=0,s=[],p=r;p<=l;p+=o){for(;i<e.length&&e[i].date.getTime()<=p;)c=e[i].points,i++;s.push({date:new Date(p).toUTCString().slice(5,16),points:c})}return console.log(s),s}},me=a(51),he=a(581),de=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={yearRange:e.getYearRange(),density:20},e.handleYearChange=function(t,a){e.setState({yearRange:a})},e.handleDensityChange=function(t,a){e.setState({density:a})},e}return Object(c.a)(a,[{key:"getYearRange",value:function(){return[this.props.playerPoints[0].date.getUTCFullYear(),this.props.playerPoints[this.props.playerPoints.length-1].date.getUTCFullYear()]}},{key:"getMaxDate",value:function(e,t){return e>t?e:t}},{key:"componentDidUpdate",value:function(e){e.playerPoints!==this.props.playerPoints&&this.setState({yearRange:this.getYearRange()})}},{key:"render",value:function(){var e=this.state,t=e.yearRange,a=e.density;return r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,null,"Year Range"),r.a.createElement(he.a,{value:this.state.yearRange,onChange:this.handleYearChange,valueLabelDisplay:"auto","aria-labelledby":"range-slider",marks:!0,step:1,min:this.getYearRange()[0],max:this.getYearRange()[1]}),r.a.createElement(B.a,null,"Chart Density"),r.a.createElement(he.a,{value:this.state.density,onChange:this.handleDensityChange,valueLabelDisplay:"auto","aria-labelledby":"range-slider",min:5,max:50}),r.a.createElement("div",{style:{width:"100%",height:300}},r.a.createElement(me.e,null,r.a.createElement(me.d,{data:ue.scalePointsByDate(this.props.playerPoints,a,this.getMaxDate(new Date(Date.UTC(t[0],0)),this.props.playerPoints[0].date),new Date(Date.UTC(t[1],0)))},r.a.createElement(me.a,{stroke:"#eee",strokeDasharray:"5 5"}),r.a.createElement(me.g,{dataKey:"date",interval:0,angle:30,dx:20}),r.a.createElement(me.h,null),r.a.createElement(me.f,null),r.a.createElement(me.b,null),r.a.createElement(me.c,{type:"monotone",dataKey:"points",stroke:"#8884d8",dot:!1,strokeWidth:2})))))}}]),a}(n.Component),fe=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={playerPoints:[]},e.handlePlayerChange=function(t,a){null===a?e.setState({playerPoints:[]}):T.a.getJSON("https://serene-crag-74633.herokuapp.com/tournaments/"+a.id).then((function(t){e.setState({playerPoints:ue.getPointsByDate(t)})})).catch((function(){console.log("error")}))},e}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(le.a,null,r.a.createElement(ne.a,{pt:5},r.a.createElement(ie.a,{container:!0,spacing:3},r.a.createElement(ce.a,{options:this.props.players,getOptionLabel:function(e){return e.name},renderInput:function(e){return r.a.createElement(D.a,Object.assign({},e,{label:"Choose a player"}))},filterOptions:Object(se.a)({limit:100}),onChange:this.handlePlayerChange}),this.state.playerPoints.length?r.a.createElement(de,{playerPoints:this.state.playerPoints}):r.a.createElement(te.a,null))))}}]),a}(n.Component),ge=Object(X.b)((function(e){return{players:e.players}}))(fe),ye=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;T.a.ajax("https://serene-crag-74633.herokuapp.com/all").then((function(t){var a=f.parseContent(t);e.props.updatePlayers(a)})).catch((function(){console.log("error")}))}},{key:"render",value:function(){return r.a.createElement(u.a,null,r.a.createElement(m.a,{exact:!0,path:"/",component:ee}),r.a.createElement(m.a,{exact:!0,path:"/progress",component:ge}))}}]),a}(n.Component);ye.displayName=ye.name;var ve=Object(X.b)(null,(function(e){return{updatePlayers:function(t){return e({type:"UPDATE_PLAYERS",payload:t})}}}))(ye);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ee=a(79),we=[];var be=Object(Ee.b)({players:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_PLAYERS":return t.payload;default:return e}}}),Ce=Object(Ee.c)(be);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(X.a,{store:Ce},r.a.createElement(ve,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[303,1,2]]]);
//# sourceMappingURL=main.1b767070.chunk.js.map