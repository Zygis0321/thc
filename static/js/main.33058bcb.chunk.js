(this.webpackJsonpthc=this.webpackJsonpthc||[]).push([[0],{109:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),l=n.n(o),c=(n(95),n(23)),i=n(24),s=n(31),m=n(30),u=n(73),p=n(13),f=(n(96),n(74)),h=n(43),d=new(function(){function e(){var t=this;Object(c.a)(this,e),this.prefScores=new Array(6005).fill(0),this.rankPlayers=function(e){for(var n=0;n<e.length;n++)-1!==e[n].lowestScore&&(e[n].newPoints=e[n].points+Math.max(0,e[n].score-e[n].lowestScore));for(var a=0;a<e.length;a++)if(-1!==e[a].lowestScore){for(var r=t.prefScores[e[a].newPoints+1]+1,o=0;o<e.length;o++)-1!==e[o].lowestScore&&(e[o].points>e[a].newPoints&&r--,e[o].newPoints>e[a].newPoints&&r++);e[a].rank=t.prefScores[e[a].points+1]+1,e[a].newRank=r}return e},this.recalc=function(e,t){for(var n=0;n<e.length;n++)e[n].pos=n+1,e[n].score=0;if(e.length<4)return e;for(var a=e.map((function(e){return e.value})).sort((function(e,t){return t-e})),r=0;r+1<e.length;r++){for(var o=0,l=r;l<Math.min(r+4,e.length);l++)o+=a[l];e[r].score=Math.max(e[r].score,o/4*t.coefficient)}for(var c=0;c<e.length;c++){var i=69*(e.length-c-1)/(e.length-1)+1;e[c].score=Math.max(e[c].score,Math.min(i,e.length-c))}for(var s=t.winnerpoints,m=0;m+1<e.length;m++)e[m].score=Math.max(e[m].score,s),s/=2;for(var u=0;u<e.length;u++){var p=(t.winnerpoints-1)*(e.length-u-1)/(e.length-1)+1;e[u].score=Math.max(e[u].score,p)}for(var f=0;f<e.length;f++)e[f].score=Math.floor(e[f].score);return e[0].score+=10,e}}return Object(i.a)(e,[{key:"parseContent",value:function(e){for(var t=e.split("\n").map((function(e){return e.split("\t")})),n=[],a=2;a+1<t.length;a++){var r={rank:Number(t[a][0]),id:t[a][1],name:t[a][2],nation:t[a][4],points:Number(t[a][5]),value:Number(t[a][6])};n.push(r)}return n}},{key:"parsePlayerMinPoints",value:function(e){var t=document.createElement("html");t.innerHTML=e;for(var n=t.getElementsByClassName("normTour"),a=1e5,r=0,o=6;o<n.length;o+=7){var l=n[o].innerHTML.indexOf("(");-1===l&&(l=n[o].innerHTML.length);var c=n[o].innerHTML.substr(0,l);a=Math.min(a,Number(c)),r++}return r<5&&(a=0),a}},{key:"setPlayerScores",value:function(e){for(var t=0;t<e.length;t++)this.prefScores[e[t].points]++;for(var n=6e3;n>=0;n--)this.prefScores[n]+=this.prefScores[n+1]}}]),e}()),v=n(164),y=n(163),g=n(168),E=function(e){Object(s.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(y.a,{open:!0,filterOptions:Object(g.a)({limit:20}),options:this.props.players,getOptionLabel:function(e){return e.name},renderInput:function(e){return r.a.createElement(v.a,Object.assign({},e,{variant:"outlined",label:"Players"}))},ListboxProps:{style:{maxHeight:"200rem"}},renderTags:function(){return null},closeIcon:null,popupIcon:null,onChange:function(t,n,a,r){"select-option"===a&&void 0!=(null===r||void 0===r?void 0:r.option)&&e.props.playerAdded(r.option),"remove-option"===a&&(null===r||void 0===r||r.option)}})}}]),n}(a.Component),w=n(55),b=n.n(w),k=n(156),C=n(162),x=n(152),j=n(150),O=n(166),S=n(161),L=n(157),P=n(158),M=n(72),R=n.n(M),I=[{name:"Level 1 (World)",coefficient:.96,winnerpoints:1e3},{name:"Level 1 (Continental)",coefficient:.96,winnerpoints:600},{name:"Level 2",coefficient:.92,winnerpoints:500},{name:"Level 3",coefficient:.89,winnerpoints:100},{name:"Level 4",coefficient:.83,winnerpoints:70},{name:"Level 5",coefficient:.6,winnerpoints:40},{name:"Level 6",coefficient:.4,winnerpoints:20}],N=n(159),A=n(111),T=n(151),W=n(153),H=n(147),B=n(58),J=n(154),z=n(155),D={boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.2)",backgroundColor:"rgb(255, 255, 255)",marginTop:"12px",marginBottom:"12px"},U={fontWeight:600,color:"#5eb560"},$={fontWeight:600,color:"#f97373"},q={fontWeight:600,color:"#969696"},F=Object(B.b)((function(e){var t=e.children;return r.a.createElement(A.a,{style:D},t)})),G=Object(B.a)((function(e){var t=e.children;return r.a.createElement(T.a,null,t)})),K=function(e){Object(s.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(G,{onSortEnd:this.props.reorder,distance:1},r.a.createElement(A.a,null,r.a.createElement(x.a,{item:!0,xs:1},r.a.createElement(W.a,null,"#")),r.a.createElement(x.a,{item:!0,xs:4},r.a.createElement(W.a,null,"Name")),r.a.createElement(x.a,{item:!0,xs:!0},r.a.createElement(W.a,null,"Rank")),r.a.createElement(x.a,{item:!0,xs:!0},r.a.createElement(W.a,null,"Points")),r.a.createElement(x.a,{item:!0,xs:2},r.a.createElement(W.a,{align:"justify"},"Tournament Points"))),this.props.playersCompare.map((function(t,n){return r.a.createElement(F,{key:n,index:n},r.a.createElement(x.a,{item:!0,xs:1},r.a.createElement(W.a,null,r.a.createElement("b",null,t.pos))),r.a.createElement(x.a,{item:!0,xs:4},r.a.createElement(W.a,null,t.name)),r.a.createElement(x.a,{item:!0,xs:!0},-1===t.lowestScore?r.a.createElement(J.a,{width:70}):r.a.createElement(x.a,{container:!0,direction:"row"},r.a.createElement(C.a,{mr:.5},r.a.createElement(W.a,null,t.newRank)),t.rank>t.newRank?r.a.createElement(W.a,{style:U},"(+".concat(Math.abs(t.rank-t.newRank),")")):t.rank===t.newRank?r.a.createElement(W.a,{style:q},"(=".concat(t.rank-t.newRank,")")):r.a.createElement(W.a,{style:$},"(-".concat(Math.abs(t.rank-t.newRank),")")))),r.a.createElement(x.a,{item:!0,xs:!0},-1===t.lowestScore?r.a.createElement(J.a,{width:70}):r.a.createElement(x.a,{container:!0,direction:"row"},r.a.createElement(C.a,{mr:.5},r.a.createElement(W.a,null,t.points)),t.points<t.newPoints?r.a.createElement(W.a,{style:U},"(+".concat(Math.abs(t.points-t.newPoints),")")):r.a.createElement(W.a,{style:q},"(=".concat(t.points-t.newPoints,")")))),r.a.createElement(x.a,{item:!0,xs:2},r.a.createElement(x.a,{container:!0,direction:"row",justify:"flex-end"},r.a.createElement(C.a,{display:"flex",alignItems:"center",justifyContent:"flex-end",marginRight:2},r.a.createElement(W.a,{align:"right"},r.a.createElement("b",null,t.score))),r.a.createElement(C.a,{display:"flex",alignItems:"center",justifyContent:"flex-end"},r.a.createElement(H.a,{size:"small",onClick:function(){return e.props.playerRemoved(t.id)}},r.a.createElement(z.a,null))))))})))}}]),n}(a.Component),Q=function(e){Object(s.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={players:[],playersCompare:[],selectedLevel:I[0].name},e.recalc=function(e,t){var n=I.find((function(e){return e.name==t})),a=n||I[0];return d.rankPlayers(d.recalc(e,a))},e.reorder=function(t){var n=t.oldIndex,a=t.newIndex;e.setState((function(t){var r=t.playersCompare;return{playersCompare:e.recalc(R()(r,n,a),e.state.selectedLevel)}}))},e.playerAdded=function(t){void 0===e.state.playersCompare.find((function(e){return e.id===t.id}))&&(e.setState((function(n){return Object(h.a)(Object(h.a)({},n),{},{playersCompare:e.recalc(n.playersCompare.concat(Object(h.a)(Object(h.a)({},t),{},{pos:n.playersCompare.length+1,score:-1,lowestScore:-1,newRank:-1,newPoints:-1})),n.selectedLevel)})})),b.a.getJSON("http://www.whateverorigin.org/get?url="+encodeURIComponent("https://stiga.trefik.cz/ithf/ranking/player.aspx?ID=".concat(t.id))+"&callback=?").then((function(n){for(var a=d.parsePlayerMinPoints(n.contents),r=Object(f.a)(e.state.playersCompare),o=0;o<r.length;o++)if(r[o].id===t.id&&-1===r[o].lowestScore){var l=Object(h.a)({},r[o]);l.lowestScore=a,r[o]=l,e.setState({playersCompare:e.recalc(r,e.state.selectedLevel)});break}})).catch((function(){console.log("error")})))},e.handleClearAllClick=function(){e.setState({playersCompare:[]})},e.playerRemoved=function(t){e.setState((function(n){var a=n.playersCompare,r=n.selectedLevel;return{playersCompare:e.recalc(a.filter((function(e){return e.id!==t})),r)}}))},e.handleLevelChange=function(t){e.setState((function(n){var a=n.playersCompare;return{selectedLevel:t.target.value,playersCompare:e.recalc(a,t.target.value)}}))},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;b.a.getJSON("http://www.whateverorigin.org/get?url="+encodeURIComponent("https://stiga.trefik.cz/ithf/ranking/ranking.txt")+"&callback=?").then((function(t){var n=d.parseContent(t.contents);d.setPlayerScores(n),e.setState({players:n})})).catch((function(){console.log("error")}))}},{key:"render",value:function(){return r.a.createElement(k.a,null,r.a.createElement(C.a,{pt:5},r.a.createElement(x.a,{container:!0,spacing:3},r.a.createElement(x.a,{item:!0,xs:3},r.a.createElement(E,{players:this.state.players,playerAdded:this.playerAdded})),r.a.createElement(x.a,{item:!0,xs:!0},r.a.createElement(x.a,{container:!0,justify:"space-between",alignItems:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement(j.a,null,r.a.createElement(O.a,null,"Level"),r.a.createElement(S.a,{value:this.state.selectedLevel,onChange:this.handleLevelChange},I.map((function(e){return r.a.createElement(L.a,{value:e.name},e.name)}))))),r.a.createElement(x.a,{item:!0},r.a.createElement(P.a,{variant:"contained",color:"secondary",startIcon:r.a.createElement(N.a,null),onClick:this.handleClearAllClick,style:{float:"right"}},"Clear"))),r.a.createElement(K,{playersCompare:this.state.playersCompare,reorder:this.reorder,playerRemoved:this.playerRemoved})))))}}]),n}(a.Component),V=function(e){Object(s.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement(u.a,null,r.a.createElement(p.a,{exact:!0,path:"/",component:Q}))}}]),n}(a.Component);V.displayName=V.name;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},90:function(e,t,n){e.exports=n(109)},95:function(e,t,n){},96:function(e,t,n){}},[[90,1,2]]]);
//# sourceMappingURL=main.33058bcb.chunk.js.map