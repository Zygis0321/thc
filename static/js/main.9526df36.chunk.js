(this.webpackJsonpthc=this.webpackJsonpthc||[]).push([[0],{304:function(e,t,a){e.exports=a(525)},309:function(e,t,a){},310:function(e,t,a){},525:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(16),o=a.n(l),i=(a(309),a(28)),c=a(29),s=a(38),p=a(37),u=a(259),m=a(19),h=(a(310),a(260)),d=a(51),f=new(function(){function e(){var t=this;Object(i.a)(this,e),this.prefScores=[],this.rankPlayers=function(e){for(var a=0;a<e.length;a++)-1!==e[a].lowestScore&&(e[a].newPoints=e[a].points+Math.max(0,e[a].score-e[a].lowestScore));for(var n=0;n<e.length;n++)if(-1!==e[n].lowestScore){for(var r=t.prefScores[e[n].newPoints+1]+1,l=0;l<e.length;l++)-1!==e[l].lowestScore&&(e[l].points>e[n].newPoints&&r--,e[l].newPoints>e[n].newPoints&&r++);e[n].rank=t.prefScores[e[n].points+1]+1,e[n].newRank=r}return e},this.recalc=function(e,t){for(var a=0;a<e.length;a++)e[a].pos=a+1,e[a].score=0;if(e.length<4)return e;for(var n=e.map((function(e){return e.value})).sort((function(e,t){return t-e})),r=0;r+1<e.length;r++){for(var l=0,o=r;o<Math.min(r+4,e.length);o++)l+=n[o];e[r].score=Math.max(e[r].score,l/4*t.coefficient)}for(var i=0;i<e.length;i++){var c=69*(e.length-i-1)/(e.length-1)+1;e[i].score=Math.max(e[i].score,Math.min(c,e.length-i))}for(var s=t.winnerpoints,p=0;p+1<e.length;p++)e[p].score=Math.max(e[p].score,s),s/=2;for(var u=0;u<e.length;u++){var m=(t.winnerpoints-1)*(e.length-u-1)/(e.length-1)+1;e[u].score=Math.max(e[u].score,m)}for(var h=0;h<e.length;h++)e[h].score=Math.floor(e[h].score);return e[0].score+=10,e}}return Object(c.a)(e,[{key:"parseContent",value:function(e){for(var t=e.split("\n").map((function(e){return e.split("\t")})),a=[],n=2;n+1<t.length;n++){var r={rank:Number(t[n][0]),id:t[n][1],name:t[n][2],club:t[n][3],nation:t[n][4],points:Number(t[n][5]),value:Number(t[n][6])};a.push(r)}return a}},{key:"parsePlayerMinPoints",value:function(e){var t=document.createElement("html");t.innerHTML=e;for(var a=t.getElementsByClassName("normTour"),n=1e5,r=0,l=6;l<a.length;l+=7){var o=a[l].innerHTML.indexOf("(");-1===o&&(o=a[l].innerHTML.length);var i=a[l].innerHTML.substr(0,o);n=Math.min(n,Number(i)),r++}return r<5&&(n=0),n}},{key:"setPlayerScores",value:function(e){this.prefScores=new Array(6005).fill(0);for(var t=0;t<e.length;t++)this.prefScores[e[t].points]++;for(var a=6e3;a>=0;a--)this.prefScores[a]+=this.prefScores[a+1]}}]),e}()),g=a(561),y=a(560),v=a(529),E=a(563),b=a(564),w=a(577),C=a(581),D=a(578),k=a(562),x=a(567),j=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={searchText:""},e.handleSearchChange=function(t){e.setState({searchText:t.target.value})},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{label:"Players",variant:"outlined",onChange:this.handleSearchChange,fullWidth:!0,InputProps:{endAdornment:r.a.createElement(g.a,{position:"end"},r.a.createElement(k.a,{color:"action"}))}}),r.a.createElement(y.a,{dense:!0},(this.props.players.length?this.props.players.filter((function(t){return t.name.toLowerCase().includes(e.state.searchText.toLowerCase())})).slice(0,10):Array.from(new Array(10))).map((function(t){return t?r.a.createElement(v.a,{key:t.id,button:!0,onClick:function(){return e.props.handlePlayerToggle(t)}},r.a.createElement(E.a,{id:t.id+t.name,primary:t.name,secondary:t.club}),r.a.createElement(b.a,null,r.a.createElement(w.a,{edge:"end",onChange:function(){return e.props.handlePlayerToggle(t)},checked:e.props.playersCompare.some((function(e){return e.id==t.id}))}))):r.a.createElement(C.a,{pt:2,pl:1,pr:1},r.a.createElement(x.a,null),r.a.createElement(x.a,{width:"60%"}))}))))}}]),a}(n.Component),O=a(79),P=a.n(O),T=a(570),S=a(568),R=a(557),U=a(580),L=a(575),A=a(571),M=a(572),F=a(244),Y=a.n(F),W=[{name:"Level 1 (World)",coefficient:.96,winnerpoints:1e3},{name:"Level 1 (Continental)",coefficient:.96,winnerpoints:600},{name:"Level 2",coefficient:.92,winnerpoints:500},{name:"Level 3",coefficient:.89,winnerpoints:100},{name:"Level 4",coefficient:.83,winnerpoints:70},{name:"Level 5",coefficient:.6,winnerpoints:40},{name:"Level 6",coefficient:.4,winnerpoints:20}],I=[{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:0,percentage:1},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(2020,9,4)),tournamentAge:2,percentage:.8},{appliedFrom:new Date(Date.UTC(2020,9,5)),appliedUntil:new Date(Date.UTC(2021,5,30)),tournamentAge:2,percentage:1},{appliedFrom:new Date(Date.UTC(2021,6,1)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:2,percentage:.8},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:3,percentage:.6},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:4,percentage:.4},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:5,percentage:.2},{appliedFrom:new Date(Date.UTC(1111,0)),appliedUntil:new Date(Date.UTC(3333,0)),tournamentAge:6,percentage:0}],N=(new Date(Date.UTC(2020,9,5)),new Date(Date.UTC(2021,6,1)),a(573)),B=a(565),H=a(173),z=a(569),J=a(97),Q=a.n(J),K={boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.2)",backgroundColor:"rgb(255, 255, 255)",marginTop:"12px",marginBottom:"12px"},V=Object(d.a)(Object(d.a)({},K),{},{paddingRight:"5px",paddingLeft:"10px"}),_={fontWeight:600,color:"#5eb560"},$={fontWeight:600,color:"#f97373"},q={fontWeight:600,color:"#969696"},G=Object(H.b)((function(e){var t=e.children,a=Object(J.useMediaQuery)({maxWidth:767});return r.a.createElement(v.a,{style:a?V:K},t)})),X=Object(H.a)((function(e){var t=e.children,a=Object(J.useMediaQuery)({maxWidth:767});return r.a.createElement(y.a,{dense:a},t)})),Z=function(e){var t=e.children,a=Object(J.useMediaQuery)({maxWidth:767});return r.a.createElement(v.a,{style:a?{paddingRight:"5px",paddingLeft:"10px"}:void 0},t)},ee=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(X,{onSortEnd:this.props.reorder,shouldCancelStart:function(e){if("buttonRemove"==e.target.id||void 0!==e.target.nearestViewportElement&&"buttonRemove"===e.target.nearestViewportElement.id)return!0},useWindowAsScrollContainer:!0},r.a.createElement(Z,null,r.a.createElement(S.a,{item:!0,xs:1},r.a.createElement(E.a,null,"#")),r.a.createElement(S.a,{item:!0,xs:3,sm:3,md:4},r.a.createElement(E.a,null,"Name")),r.a.createElement(S.a,{item:!0,xs:!0},r.a.createElement(E.a,null,"Rank")),r.a.createElement(S.a,{item:!0,xs:!0},r.a.createElement(E.a,null,"Points")),r.a.createElement(S.a,{item:!0,xs:3,sm:3,md:2},r.a.createElement(E.a,{style:{textAlign:"right"}},"Tournament Points"))),this.props.playersCompare.map((function(t,a){return r.a.createElement(G,{key:a,index:a},r.a.createElement(S.a,{item:!0,xs:1},r.a.createElement(E.a,null,r.a.createElement("b",null,t.pos))),r.a.createElement(S.a,{item:!0,xs:3,sm:3,md:4},r.a.createElement(E.a,null,t.name)),r.a.createElement(S.a,{item:!0,xs:!0},-1===t.lowestScore?r.a.createElement(x.a,{width:70}):r.a.createElement(S.a,{container:!0,direction:"row"},r.a.createElement(C.a,{mr:.5},r.a.createElement(E.a,null,t.newRank)),t.rank>t.newRank?r.a.createElement(E.a,{style:_},r.a.createElement("b",null,"(+".concat(Math.abs(t.rank-t.newRank),")"))):t.rank===t.newRank?r.a.createElement(E.a,{style:q},r.a.createElement("b",null,"(=".concat(t.rank-t.newRank,")"))):r.a.createElement(E.a,{style:$},r.a.createElement("b",null,"(-".concat(Math.abs(t.rank-t.newRank),")"))))),r.a.createElement(S.a,{item:!0,xs:!0},-1===t.lowestScore?r.a.createElement(x.a,{width:70}):r.a.createElement(S.a,{container:!0,direction:"row"},r.a.createElement(C.a,{mr:.5},r.a.createElement(E.a,null,t.newPoints)),t.points<t.newPoints?r.a.createElement(E.a,{style:_},r.a.createElement("b",null,"(+".concat(Math.abs(t.points-t.newPoints),")"))):r.a.createElement(E.a,{style:q},r.a.createElement("b",null," ","(=".concat(t.points-t.newPoints,")"))))),r.a.createElement(S.a,{item:!0,xs:3,sm:3,md:2,style:{minWidth:"60px"}},r.a.createElement(S.a,{container:!0,direction:"row",justify:"flex-end"},r.a.createElement(Q.a,{maxWidth:767},(function(a){return a?r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{display:"flex",alignItems:"center",justifyContent:"flex-end",marginRight:"2px"},r.a.createElement(E.a,null,r.a.createElement("b",null,t.score))),r.a.createElement(B.a,{size:"small",onClick:function(){return e.props.playerRemoved(t.id)},id:"buttonRemove"},r.a.createElement(z.a,{fontSize:"small",id:"buttonRemove"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{display:"flex",alignItems:"center",justifyContent:"flex-end",marginRight:2},r.a.createElement(E.a,null,r.a.createElement("b",null,t.score))),r.a.createElement(B.a,{size:"small",onClick:function(){return e.props.playerRemoved(t.id)},id:"buttonRemove"},r.a.createElement(z.a,{id:"buttonRemove"})))})))))})))}}]),a}(n.Component),te=a(60),ae=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={playersCompare:[],selectedLevel:W[0].name},e.recalc=function(e,t){var a=W.find((function(e){return e.name==t})),n=a||W[0];return f.rankPlayers(f.recalc(e,n))},e.reorder=function(t){var a=t.oldIndex,n=t.newIndex;e.setState((function(t){var r=t.playersCompare;return{playersCompare:e.recalc(Y()(r,a,n),e.state.selectedLevel)}}))},e.handlePlayerToggle=function(t){e.state.playersCompare.some((function(e){return e.id==t.id}))?e.playerRemoved(t.id):e.playerAdded(t)},e.playerAdded=function(t){e.setState((function(a){return Object(d.a)(Object(d.a)({},a),{},{playersCompare:e.recalc(a.playersCompare.concat(Object(d.a)(Object(d.a)({},t),{},{pos:a.playersCompare.length+1,score:-1,lowestScore:-1,newRank:-1,newPoints:-1})),a.selectedLevel)})})),P.a.ajax("https://serene-crag-74633.herokuapp.com/single/"+t.id).then((function(a){for(var n=Number(a),r=Object(h.a)(e.state.playersCompare),l=0;l<r.length;l++)if(r[l].id===t.id&&-1===r[l].lowestScore){var o=Object(d.a)({},r[l]);o.lowestScore=n,r[l]=o,e.setState({playersCompare:e.recalc(r,e.state.selectedLevel)});break}})).catch((function(){console.log("error")}))},e.handleClearAllClick=function(){e.setState({playersCompare:[]})},e.playerRemoved=function(t){e.setState((function(a){var n=a.playersCompare,r=a.selectedLevel;return{playersCompare:e.recalc(n.filter((function(e){return e.id!==t})),r)}}))},e.handleLevelChange=function(t){e.setState((function(a){var n=a.playersCompare;return{selectedLevel:t.target.value,playersCompare:e.recalc(n,t.target.value)}}))},e}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e){0===e.players.length&&this.props.players.length>0&&f.setPlayerScores(this.props.players)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement(T.a,null,r.a.createElement(C.a,{pt:5},r.a.createElement(S.a,{container:!0,spacing:3},r.a.createElement(S.a,{item:!0,xs:12,sm:3,style:{minWidth:"200px"}},r.a.createElement(j,{players:this.props.players,handlePlayerToggle:this.handlePlayerToggle,playersCompare:this.state.playersCompare})),r.a.createElement(S.a,{item:!0,xs:12,sm:!0},r.a.createElement(S.a,{container:!0,justify:"space-between",alignItems:"center"},r.a.createElement(S.a,{item:!0},r.a.createElement(R.a,null,r.a.createElement(U.a,null,"Level"),r.a.createElement(L.a,{value:this.state.selectedLevel,onChange:this.handleLevelChange},W.map((function(e){return r.a.createElement(A.a,{value:e.name},e.name)}))))),r.a.createElement(S.a,{item:!0},r.a.createElement(M.a,{variant:"contained",color:"secondary",startIcon:r.a.createElement(N.a,null),onClick:this.handleClearAllClick,style:{float:"right"}},"Clear"))),r.a.createElement(ee,{playersCompare:this.state.playersCompare,reorder:this.reorder,playerRemoved:this.playerRemoved})))))}}]),a}(n.Component),ne=Object(te.b)((function(e){return{players:e.players}}))(ae);var re=a(574),le=a(256),oe=a.n(le),ie=a(255),ce=a.n(ie),se=a(257),pe=a.n(se),ue=a(576),me=a(583),he=a(168),de=new function e(){var t=this;Object(i.a)(this,e),this.addYears=function(e,t){var a=new Date(e);return new Date(a.setFullYear(a.getFullYear()+t))},this.getPointsByDate=function(e){for(var a=Date.now(),n=[],r=0;r<e.length;r++){var l,o=Object(he.a)(I);try{for(o.s();!(l=o.n()).done;){var i=l.value,c=t.addYears(e[r].date,i.tournamentAge);c<i.appliedFrom||c>i.appliedUntil||n.push({date:c,points:Math.round(e[r].points*i.percentage),ind:r})}}catch(f){o.e(f)}finally{o.f()}}n=n.sort((function(e,t){return new Date(e.date).getTime()-new Date(t.date).getTime()}));var s,p=[],u=[],m=Object(he.a)(n);try{var h=function(){var e=s.value;(p=p.filter((function(t){return t.ind!==e.ind}))).push(e),p=p.sort((function(e,t){return t.points-e.points}));for(var t=0,a=0;a<Math.min(p.length,5);a++)t+=p[a].points;u.push({date:e.date,points:t})};for(m.s();!(s=m.n()).done;)h()}catch(f){m.e(f)}finally{m.f()}var d=Date.now();return console.log("elapsed "+(d-a)),u},this.scalePointsByDate=function(e,t,a,n){for(var r=a.getTime(),l=n.getTime(),o=(l-r)/t,i=0,c=0,s=[],p=r;p<l;p+=o){for(;i<e.length&&e[i].date.getTime()<=p;)c=e[i].points,i++;s.push({date:new Date(p).toUTCString().slice(5,16),points:c})}return console.log(s),s}},fe=a(52),ge=a(100),ye=a(582),ve=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={yearRange:e.getYearRange(),density:20},e.handleYearChange=function(t,a){e.setState({yearRange:a})},e.handleDensityChange=function(t,a){e.setState({density:a})},e}return Object(c.a)(a,[{key:"getYearRange",value:function(){return[this.props.playerPoints[0].date.getUTCFullYear(),this.props.playerPoints[this.props.playerPoints.length-1].date.getUTCFullYear()]}},{key:"getMaxDate",value:function(e,t){return e>t?e:t}},{key:"componentDidUpdate",value:function(e){e.playerPoints!==this.props.playerPoints&&this.setState({yearRange:this.getYearRange()})}},{key:"render",value:function(){var e=this.state,t=e.yearRange,a=e.density;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ge.a,null,"Year Range"),r.a.createElement(ye.a,{value:this.state.yearRange,onChange:this.handleYearChange,valueLabelDisplay:"auto","aria-labelledby":"range-slider",marks:!0,step:1,min:this.getYearRange()[0],max:this.getYearRange()[1]}),r.a.createElement(ge.a,null,"Chart Density"),r.a.createElement(ye.a,{value:this.state.density,onChange:this.handleDensityChange,valueLabelDisplay:"auto","aria-labelledby":"range-slider",min:5,max:50}),r.a.createElement("div",{style:{width:"100%",height:300}},r.a.createElement(fe.e,null,r.a.createElement(fe.d,{data:de.scalePointsByDate(this.props.playerPoints,a,this.getMaxDate(new Date(Date.UTC(t[0],0)),this.props.playerPoints[0].date),new Date(Date.UTC(t[1],0)))},r.a.createElement(fe.a,{stroke:"#eee",strokeDasharray:"3 3"}),r.a.createElement(fe.g,{dataKey:"date",interval:0,angle:30,dx:20}),r.a.createElement(fe.h,null),r.a.createElement(fe.f,null),r.a.createElement(fe.b,null),r.a.createElement(fe.c,{type:"monotone",dataKey:"points",stroke:"#8884d8",dot:!1,strokeWidth:2})))))}}]),a}(n.Component),Ee=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={playerPoints:[]},e.handlePlayerChange=function(t,a){null===a?e.setState({playerPoints:[]}):P.a.getJSON("https://serene-crag-74633.herokuapp.com/tournaments/"+a.id).then((function(t){e.setState({playerPoints:de.getPointsByDate(t)})})).catch((function(){console.log("error")}))},e}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(ce.a,null,r.a.createElement(oe.a,{pt:5},r.a.createElement(pe.a,{container:!0,spacing:3},r.a.createElement(ue.a,{options:this.props.players,getOptionLabel:function(e){return e.name},renderInput:function(e){return r.a.createElement(D.a,Object.assign({},e,{label:"Choose a player"}))},filterOptions:Object(me.a)({limit:100}),onChange:this.handlePlayerChange}),this.state.playerPoints.length?r.a.createElement(ve,{playerPoints:this.state.playerPoints}):r.a.createElement(re.a,null))))}}]),a}(n.Component),be=Object(te.b)((function(e){return{players:e.players}}))(Ee),we=function(e){Object(s.a)(a,e);var t=Object(p.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;P.a.ajax("https://serene-crag-74633.herokuapp.com/all").then((function(t){var a=f.parseContent(t);e.props.updatePlayers(a)})).catch((function(){console.log("error")}))}},{key:"render",value:function(){return r.a.createElement(u.a,null,r.a.createElement(m.a,{exact:!0,path:"/",component:ne}),r.a.createElement(m.a,{exact:!0,path:"/progress",component:be}))}}]),a}(n.Component);we.displayName=we.name;var Ce=Object(te.b)(null,(function(e){return{updatePlayers:function(t){return e({type:"UPDATE_PLAYERS",payload:t})}}}))(we);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var De=a(80),ke=[];var xe=Object(De.b)({players:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_PLAYERS":return t.payload;default:return e}}}),je=Object(De.c)(xe);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(te.a,{store:je},r.a.createElement(Ce,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[304,1,2]]]);
//# sourceMappingURL=main.9526df36.chunk.js.map